---
title: "Class 05: Data Visualization with ggplot"
author: "Mitchell Sullivan (PID: A18595276)"
format: pdf
toc: true
---

## Background

There are lots of ways to make plots in R. These include so-called "base R" (like the `plot()`) and add on packages like **ggplot2**.

Let's make the same plot with these two graphics systems. We can use the inbuilt `cars` dataset:

```{r}
head(cars)
```

With "base R" we can simply:

```{r}
plot(cars)
```

Now let's try ggplot. First I need to install the package using `install.packages("ggplot2")`.

> **N.B.** We never run an `install.packages` in a code chunk otherwise we will re-install needlessly every time we render our document.

Every time we want to use an add-on package, we need to load it up with a call to `library()`

```{r}
library(ggplot2)
ggplot(cars)
```

Every ggplot needs at least 3 things:

1. The **data** i/e/ stuff to plot as a data.frame
2. The **aes** or aesthetics that map the data to the plot
3. The **geom** or geometry i.e. the plot type such as points, lines, etc.

```{r}
ggplot(cars) +
  aes(x = speed, y = dist) +
  geom_point() +
  geom_smooth(method = lm, se = F) +
  labs(title = "Stopping Distance of Old Cars",
       x = "Speed (mph)",
       y = "Distance (ft)"
       ) +
  theme_bw()
```

## Gene Epxression Plot

Read some data on the effects of GLP-1 inhibitor (drug) on gene expression values:

```{r}
url <- "https://bioboot.github.io/bimm143_S20/class-material/up_down_expression.txt"
genes <- read.delim(url)
head(genes)
```

Version 1 plot - start simple by getting some ink on the page:

```{r}
ggplot(genes) +
  aes(Condition1, Condition2) +
  geom_point(alpha = 0.2, col = "blue") +
  theme_minimal()
```

Let's color by `State` up, down, or no change:

```{r}
table(genes$State)
```

```{r}
ggplot(genes) +
  aes(Condition1, Condition2, col = State) +
  geom_point() +
  scale_colour_manual( values=c("purple","grey", "green") ) +
  theme_minimal()
```

Version final plot:

```{r}
ggplot(genes) +
  aes(Condition1, Condition2, col = State) +
  geom_point() +
  scale_colour_manual(values = c("purple","grey", "green")) +
  labs(title="Gene Expresion Changes Upon GLP-1 Treatment",
         x="Control (no drug)",
         y="Drug Treatment") +
  theme_minimal()
```

## Going further with gapminder

Here we explore the famous `gapminder` dataset with some custom plots.

```{r}
url <- "https://raw.githubusercontent.com/jennybc/gapminder/master/inst/extdata/gapminder.tsv"

gapminder <- read.delim(url)
head(gapminder)
```

> Q. How many rows does this dataset have?

Use the `nrow()` function

```{r}
nrow(gapminder)
```

> Q. How many different continents are there in this dataset?

Use the `table()` function

```{r}
table(gapminder$continent)
```

Version 1 plot gdpPerCap vs lifeExp for all rows:

```{r}
ggplot(gapminder) +
  aes(gdpPercap, lifeExp) +
  geom_point() +
  theme_minimal()
```

Now coloring by continent:

```{r}
ggplot(gapminder) +
  aes(gdpPercap, lifeExp, col = continent) +
  geom_point() +
  theme_minimal()
```

I want to see a plot for each continent - in ggplot lingo, this is called "faceting"

```{r}
ggplot(gapminder) +
  aes(gdpPercap, lifeExp, col = continent) +
  geom_point() +
  facet_wrap(~ continent) +
  theme_minimal()
```

## First look at the dplyr package

Another add-on package with a function called `filter()` that we want to use.

> **N.B.** Again, we never run an `install.packages` in a code chunk, but run it in the console.

```{r}
library(dplyr)
```

Using the filter function is quite easy with a pipe:

```{r}
input <- gapminder |> filter(year == 2007 | year == 1977)
```

Now let's plot our filtered data:

```{r}
ggplot(input) +
  aes(gdpPercap, lifeExp, col = continent) +
  geom_point() +
  facet_wrap(~ year)+
  theme_minimal()
```

